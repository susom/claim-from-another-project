{
	"name": "ClaimFromAnotherProject",

	"namespace": "Stanford\\ClaimFromAnotherProject",

	"description": "This basic EM will claim a record from an external project and copy over specified fields (including file fields) to the source project.  This was developed to facilitate obtaining files from an external project on a per-record basis",

	"documentation": "README.md",

	"authors": [
		{
			"name": "Andrew Martin",
			"email": "andy123@stanford.edu",
			"institution": "Stanford University"
		}
	],

	"permissions": [
		"redcap_module_system_enable",
		"redcap_module_project_enable",
		"redcap_module_save_configuration",
        "redcap_save_record"
	],

	"enable-every-page-hooks-on-system-pages": false,

	"links": {
		"project": [

		],
		"control-center": [

		]
	},

	"no-auth-pages": [

	],

	"project-settings": [
        {
			"key": "claim-logic",
			"name": "<b>Claim Logic</b><br>This is evaluated in THIS project on save for each record.  When this logic is true, a record will be claimed from the external project.  This logic should include logic to prevent a re-save from claiming another remote record.<br>(e.g. [is_worthy(1)] = '1' AND [map_field_below] = '')",
			"required": true,
			"type": "text"
		},
        {
			"key": "external-project",
			"name": "<b>External Project</b><br>Project that has records to be claimed",
			"required": true,
			"type": "project-id"
		},
		{
			"key": "external-logic",
			"name": "<b>Logic for Available Records</b><br>This logic is evaluated on the EXTERNAL PROJECT to determine which records are available to be claimed<br>(e.g. [claimed_by] = '')",
			"required": true,
			"type": "text"
		},
		{
			"key": "external-used-field",
			"name": "<b>External Allocated Field</b><br>Field in external project to store record id from this project to mark as used<br>(e.g. claimed_by)",
			"required": true,
			"type": "text"
		},
		{
			"key": "external-date-field",
			"name": "<b>External Date Used Field</b> <i>(optional)</i><br>Store timestamp of when record was claimed<br>(e.g. date_claimed) -- must be text or datetime field type",
			"required": false,
			"type": "text"
		},
        {
            "key": "instance",
            "name": "<b>Map fields from external project to this project</b><br>When a record is claimed, these fields from the external project will be mapped into this project",
            "required": true,
            "type": "sub_settings",
            "repeatable": true,
            "sub_settings": [
                {
                    "key": "external-field",
                    "name": "<b>Field name in external project</b>",
                    "required": true,
                    "type": "text"
                },
                {
                    "key": "this-field",
                    "name": "<b>Field name in this project</b>",
                    "required": true,
                    "type": "field-list"
                },
                {
                    "key": "this-event",
                    "name": "<b>Event in this project</b>",
                    "required": true,
                    "type": "event-list"
                }
            ]
        },
        {
            "key": "enable-project-debug-logging",
            "name": "<b>Enable Debug Logging</b></h6><i> (Requires emLogger)</i><br>If you have questions enabling debugging, please contact the REDCap team for help.",
            "required": false,
            "type": "checkbox"
        }
	],


	"system-settings": [
		{
			"key": "enable-system-debug-logging",
			"name": "<b>Enable Debug Logging (system-wide)</b><i>(optional)</i> Requires installation and configuration of emLogger",
			"required": false,
			"type": "checkbox"
		}
	],

	"compatibility": {
		"php-version-min": "",
		"php-version-max": "",
		"redcap-version-min": "",
		"redcap-version-max": ""
	}
}
